todo: add this and cleanup