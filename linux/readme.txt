All credit to dmicha16

Linux version has same approach, set up settings, read, write. 

Please note that this works well for our specific use-case but there
is no guarentee that it works for others.